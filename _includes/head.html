
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | default: site.title }}</title>

  <!-- SEO -->
  {% include seo.html %}

  <!-- Atom Feed -->
  {% unless site.atom_feed.hide %}
    <link href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ '/feed.xml' | relative_url }}{% endif %}" 
          type="application/atom+xml" rel="alternate" title="{{ site.title }} Feed">
  {% endunless %}

  <!-- Favicon -->
  <link rel="icon" href="{{ "/favicon-16x16.png" | relative_url }}" type="image/png">

  <!-- JavaScript Detection -->
  <script>
    document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
    {% if site.enable_copy_code_button -%}
      window.enable_copy_code_button = true;
    {%- endif %}
  </script>

  <!-- Stylesheets -->
  {% if jekyll.environment == 'production' %}
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  {% else %}
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  {% endif %}

  <!-- Font Awesome (with performance optimization) -->
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" 
        as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">
  </noscript>

  <!-- Google Site Verification -->
  {% if site.google_site_verification %}
    <meta name="google-site-verification" content="{{ site.google_site_verification }}">
  {% endif %}

  
<!-- Content Security Policy -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net/ https://www.googletagmanager.com/ https://www.google-analytics.com/ https://utteranc.es;
  style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/;
  img-src 'self' data: *;
  font-src 'self' https://cdn.jsdelivr.net/;
  connect-src 'self' https://utteranc.es https://region1.google-analytics.com https://www.google-analytics.com;
  frame-src 'self' https://utteranc.es;
  frame-ancestors 'self' https://utteranc.es;
">
  
  <!-- Custom Head Scripts -->
  {% if site.head_scripts %}
    {% for script in site.head_scripts %}
      <script src="{{ script | relative_url }}"></script>
    {% endfor %}
  {% endif %}

  <!-- Analytics (production only) -->
  {% if jekyll.environment == "production" %}
    {% include analytics.html %}
  {% endif %}
</head>
